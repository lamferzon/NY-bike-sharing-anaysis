\subsection{Description of the HDGM}
Given $y(\boldsymbol{s},t)$  the response of a variable in position $\boldsymbol{s}$ at a discrete time $t$, where $\boldsymbol{s}$ belongs to a station of our geographic network, the univariate HDGM is defined according to the following formula:
\begin{displaymath}
	y(\boldsymbol{s}, t) = \boldsymbol{x}_\beta(\boldsymbol{s}, t)' \cdot \boldsymbol{\beta} + a \cdot z(\boldsymbol{s}, t) + \epsilon(\boldsymbol{s}, t)
\end{displaymath}
\begin{displaymath}
	z(\boldsymbol{s}, t) = g \cdot z(\boldsymbol{s}, t-1) + \eta(\boldsymbol{s}, t)
\end{displaymath}
Where $\boldsymbol{\beta}$ is a vector of fixed effects, $a$ is a scale coefficient, while $\boldsymbol{x}_\beta(\boldsymbol{s}, t)'$ is the fixed effects design vector. The $\epsilon(\boldsymbol{s}, t)$ term is the univariate Gaussian measurement error independent in space and time, and $z(\boldsymbol{s}, t)$ is a latent random variable with Markovian dynamics ruled by $g$, the transition coefficient. The innovation $\eta(\boldsymbol{s}, t)$ is a sequence of unit variance Gaussian random fields independent in time, so is a $GP(0, \rho(\lVert \boldsymbol{s}-\boldsymbol{s'} \rVert;\boldsymbol{\theta}))$, where $\lVert \boldsymbol{s}-\boldsymbol{s'} \rVert$ is the Euclidean distance between $\boldsymbol{s}$ and $\boldsymbol{s'}$, the stations of our geographic network and $\rho(\lVert \boldsymbol{s}-\boldsymbol{s'} \rVert;\boldsymbol{\theta}))$ is a valid spatial correlation function with range parameters $\boldsymbol{\theta}$. \par The model parameter set is $\boldsymbol{\psi} = \{\boldsymbol{\beta}, a, \sigma_\epsilon^2, \boldsymbol{\theta}, g\}$, we will use the EM algorithm again to estimate $\boldsymbol{\psi}$. A benefit of the EM algorithm is that it is considered stable even when the number of parameters in $\boldsymbol{\psi}$ is not small, as in the analysis of the next chapter. The main reason is that every iteration of the EM algorithm have closed form expressions for a good part of the HDGM parameters, which improves numerical stability over Newtonâ€“Raphson and similar algorithms. \par We will use the univariate HDGM to evaluate our two response variables, then we will move on to the bivariate case, evaluating both the average daily demand and the average daily rental duration. In the bivariate case the model becomes the following:
\begin{displaymath}
	\boldsymbol{y}(\boldsymbol{s}, t) = \boldsymbol{X}_\beta(\boldsymbol{s}, t)' \cdot \boldsymbol{\beta} + \boldsymbol{z}(\boldsymbol{s}, t) + \boldsymbol{\epsilon}(\boldsymbol{s}, t)
\end{displaymath}
\begin{displaymath}
	\boldsymbol{z}(\boldsymbol{s}, t) = \boldsymbol{G} \cdot \boldsymbol{z}(\boldsymbol{s}, t-1) + \boldsymbol{\eta}(\boldsymbol{s}, t)
\end{displaymath}
The structure is very similar to the univariate case, but it is important to note that the size of the terms changes. First, $\boldsymbol{y}(\boldsymbol{s}, t)$ is no longer a scalar but is a two dimensions vector, like $\boldsymbol{z}(\boldsymbol{s}, t)$. Similarly $\boldsymbol{X}_\beta(\boldsymbol{s}, t)'$ become the fixed effects design matrix. A significant difference is in $\boldsymbol{\eta}(\boldsymbol{s},t)$ because now is a $GP(0,\boldsymbol{V} \cdot \rho(\lVert \boldsymbol{s}-\boldsymbol{s}' \rVert; \boldsymbol{\theta}))$, where $V$ is a variance-covariance matrix of the two variable, including the scaling matrix $\boldsymbol{A}$. \par The HDGM is estimated similarly to the DCM, but we only have the $\boldsymbol{z}(\boldsymbol{s},t)$ latent variable which is estimated in the E-step by the Kalman smoother, while in DCM we use the formulas of the normal multivariate to estimate $\boldsymbol{w}(\boldsymbol{s}, t)$. Assuming that $\boldsymbol{y}(\boldsymbol{s}, t)$ is not observed at the spatial prediction locations, the Kalman smoother does also the spatial prediction. Fortunately, we have no missing values in our case study, but this function, implemented in D-STEM, will be useful in the validation phase.